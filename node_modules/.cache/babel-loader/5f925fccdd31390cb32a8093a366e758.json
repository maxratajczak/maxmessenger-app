{"ast":null,"code":"import { useMemo, useReducer, useEffect, useRef } from 'react';\nimport { queryEqual, refEqual, getDocs, getDocsFromCache, getDocsFromServer, onSnapshot, getDoc, getDocFromCache, getDocFromServer } from 'firebase/firestore';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar defaultState = function (defaultValue) {\n  return {\n    loading: defaultValue === undefined || defaultValue === null,\n    value: defaultValue\n  };\n};\n\nvar reducer = function () {\n  return function (state, action) {\n    switch (action.type) {\n      case 'error':\n        return __assign({}, state, {\n          error: action.error,\n          loading: false,\n          value: undefined\n        });\n\n      case 'reset':\n        return defaultState(action.defaultValue);\n\n      case 'value':\n        return __assign({}, state, {\n          error: undefined,\n          loading: false,\n          value: action.value\n        });\n\n      default:\n        return state;\n    }\n  };\n};\n\nvar useLoadingValue = function (getDefaultValue) {\n  var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n\n  var _a = useReducer(reducer(), defaultState(defaultValue)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var reset = function () {\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n    dispatch({\n      type: 'reset',\n      defaultValue: defaultValue\n    });\n  };\n\n  var setError = function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  };\n\n  var setValue = function (value) {\n    dispatch({\n      type: 'value',\n      value: value\n    });\n  };\n\n  return useMemo(function () {\n    return {\n      error: state.error,\n      loading: state.loading,\n      reset: reset,\n      setError: setError,\n      setValue: setValue,\n      value: state.value\n    };\n  }, [state.error, state.loading, reset, setError, setValue, state.value]);\n};\n\nvar useComparatorRef = function (value, isEqual, onChange) {\n  var ref = useRef(value);\n  useEffect(function () {\n    if (!isEqual(value, ref.current)) {\n      ref.current = value;\n\n      if (onChange) {\n        onChange();\n      }\n    }\n  });\n  return ref;\n};\n\nvar snapshotToData = function (snapshot, snapshotOptions, idField, refField, transform) {\n  if (!snapshot.exists()) {\n    return undefined;\n  }\n\n  var data = snapshot.data(snapshotOptions);\n\n  if (transform) {\n    data = transform(data);\n  }\n\n  if (idField) {\n    data[idField] = snapshot.id;\n  }\n\n  if (refField) {\n    data[refField] = snapshot.ref;\n  }\n\n  return data;\n};\n\nvar isRefEqual = function (v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && refEqual(v1, v2);\n  return bothNull || equal;\n};\n\nvar useIsFirestoreRefEqual = function (value, onChange) {\n  return useComparatorRef(value, isRefEqual, onChange);\n};\n\nvar isQueryEqual = function (v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && queryEqual(v1, v2);\n  return bothNull || equal;\n};\n\nvar useIsFirestoreQueryEqual = function (value, onChange) {\n  return useComparatorRef(value, isQueryEqual, onChange);\n};\n\nvar useCollection = function (query, options) {\n  return useCollectionInternal(true, query, options);\n};\n\nvar useCollectionOnce = function (query, options) {\n  return useCollectionInternal(false, query, options);\n};\n\nvar useCollectionData = function (query, options) {\n  return useCollectionDataInternal(true, query, options);\n};\n\nvar useCollectionDataOnce = function (query, options) {\n  return useCollectionDataInternal(false, query, options);\n};\n\nvar useCollectionInternal = function (listen, query, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsFirestoreQueryEqual(query, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    if (listen) {\n      var unsubscribe_1 = options && options.snapshotListenOptions ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError) : onSnapshot(ref.current, setValue, setError);\n      return function () {\n        unsubscribe_1();\n      };\n    } else {\n      var effectActive_1 = true;\n      var get = getDocsFnFromGetOptions(options ? options.getOptions : undefined);\n      get(ref.current).then(function (result) {\n        if (effectActive_1) {\n          setValue(result);\n        }\n      }).catch(function (error) {\n        if (effectActive_1) {\n          setError(error);\n        }\n      });\n      return function () {\n        effectActive_1 = false;\n      };\n    }\n  }, [ref.current]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nvar useCollectionDataInternal = function (listen, query, options) {\n  var idField = options ? options.idField : undefined;\n  var refField = options ? options.refField : undefined;\n  var snapshotOptions = options ? options.snapshotOptions : undefined;\n  var transform = options ? options.transform : undefined;\n\n  var _a = useCollectionInternal(listen, query, options),\n      snapshots = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var values = useMemo(function () {\n    return snapshots ? snapshots.docs.map(function (doc) {\n      return snapshotToData(doc, snapshotOptions, idField, refField, transform);\n    }) : undefined;\n  }, [snapshots, snapshotOptions, idField, refField, transform]);\n  var resArray = [values, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nfunction getDocsFnFromGetOptions(_a) {\n  var source = (_a === void 0 ? {\n    source: 'default'\n  } : _a).source;\n\n  switch (source) {\n    default:\n    case 'default':\n      return getDocs;\n\n    case 'cache':\n      return getDocsFromCache;\n\n    case 'server':\n      return getDocsFromServer;\n  }\n}\n\nvar useDocument = function (docRef, options) {\n  return useDocumentInternal(true, docRef, options);\n};\n\nvar useDocumentOnce = function (docRef, options) {\n  return useDocumentInternal(false, docRef, options);\n};\n\nvar useDocumentData = function (docRef, options) {\n  return useDocumentDataInternal(true, docRef, options);\n};\n\nvar useDocumentDataOnce = function (docRef, options) {\n  return useDocumentDataInternal(false, docRef, options);\n};\n\nvar useDocumentInternal = function (listen, docRef, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsFirestoreRefEqual(docRef, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    if (listen) {\n      var unsubscribe_1 = options && options.snapshotListenOptions ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError) : onSnapshot(ref.current, setValue, setError);\n      return function () {\n        unsubscribe_1();\n      };\n    } else {\n      var effectActive_1 = true;\n      var get = getDocFnFromGetOptions(options ? options.getOptions : undefined);\n      get(ref.current).then(function (doc) {\n        if (effectActive_1) {\n          setValue(doc);\n        }\n      }).catch(function (error) {\n        if (effectActive_1) {\n          setError(error);\n        }\n      });\n      return function () {\n        effectActive_1 = false;\n      };\n    }\n  }, [ref.current]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nvar useDocumentDataInternal = function (listen, docRef, options) {\n  var idField = options ? options.idField : undefined;\n  var refField = options ? options.refField : undefined;\n  var snapshotOptions = options ? options.snapshotOptions : undefined;\n  var transform = options ? options.transform : undefined;\n\n  var _a = useDocumentInternal(listen, docRef, options),\n      snapshot = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var value = useMemo(function () {\n    return snapshot ? snapshotToData(snapshot, snapshotOptions, idField, refField, transform) : undefined;\n  }, [snapshot, snapshotOptions, idField, refField, transform]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nfunction getDocFnFromGetOptions(_a) {\n  var source = (_a === void 0 ? {\n    source: 'default'\n  } : _a).source;\n\n  switch (source) {\n    default:\n    case 'default':\n      return getDoc;\n\n    case 'cache':\n      return getDocFromCache;\n\n    case 'server':\n      return getDocFromServer;\n  }\n}\n\nexport { useCollection, useCollectionOnce, useCollectionData, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };","map":{"version":3,"sources":["/Users/maximilian/GitHub/maxmessenger-app/node_modules/react-firebase-hooks/firestore/dist/index.esm.js"],"names":["useMemo","useReducer","useEffect","useRef","queryEqual","refEqual","getDocs","getDocsFromCache","getDocsFromServer","onSnapshot","getDoc","getDocFromCache","getDocFromServer","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defaultState","defaultValue","loading","undefined","value","reducer","state","action","type","error","useLoadingValue","getDefaultValue","_a","dispatch","reset","setError","setValue","useComparatorRef","isEqual","onChange","ref","current","snapshotToData","snapshot","snapshotOptions","idField","refField","transform","exists","data","id","isRefEqual","v1","v2","bothNull","equal","useIsFirestoreRefEqual","isQueryEqual","useIsFirestoreQueryEqual","useCollection","query","options","useCollectionInternal","useCollectionOnce","useCollectionData","useCollectionDataInternal","useCollectionDataOnce","listen","unsubscribe_1","snapshotListenOptions","effectActive_1","get","getDocsFnFromGetOptions","getOptions","then","result","catch","resArray","snapshots","values","docs","map","doc","source","useDocument","docRef","useDocumentInternal","useDocumentOnce","useDocumentData","useDocumentDataInternal","useDocumentDataOnce","getDocFnFromGetOptions"],"mappings":"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","sourcesContent":["import { useMemo, useReducer, useEffect, useRef } from 'react';\nimport { queryEqual, refEqual, getDocs, getDocsFromCache, getDocsFromServer, onSnapshot, getDoc, getDocFromCache, getDocFromServer } from 'firebase/firestore';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar defaultState = function (defaultValue) {\r\n    return {\r\n        loading: defaultValue === undefined || defaultValue === null,\r\n        value: defaultValue,\r\n    };\r\n};\r\nvar reducer = function () { return function (state, action) {\r\n    switch (action.type) {\r\n        case 'error':\r\n            return __assign({}, state, { error: action.error, loading: false, value: undefined });\r\n        case 'reset':\r\n            return defaultState(action.defaultValue);\r\n        case 'value':\r\n            return __assign({}, state, { error: undefined, loading: false, value: action.value });\r\n        default:\r\n            return state;\r\n    }\r\n}; };\r\nvar useLoadingValue = (function (getDefaultValue) {\r\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n    var _a = useReducer(reducer(), defaultState(defaultValue)), state = _a[0], dispatch = _a[1];\r\n    var reset = function () {\r\n        var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n        dispatch({ type: 'reset', defaultValue: defaultValue });\r\n    };\r\n    var setError = function (error) {\r\n        dispatch({ type: 'error', error: error });\r\n    };\r\n    var setValue = function (value) {\r\n        dispatch({ type: 'value', value: value });\r\n    };\r\n    return useMemo(function () { return ({\r\n        error: state.error,\r\n        loading: state.loading,\r\n        reset: reset,\r\n        setError: setError,\r\n        setValue: setValue,\r\n        value: state.value,\r\n    }); }, [state.error, state.loading, reset, setError, setValue, state.value]);\r\n});\n\nvar useComparatorRef = function (value, isEqual, onChange) {\r\n    var ref = useRef(value);\r\n    useEffect(function () {\r\n        if (!isEqual(value, ref.current)) {\r\n            ref.current = value;\r\n            if (onChange) {\r\n                onChange();\r\n            }\r\n        }\r\n    });\r\n    return ref;\r\n};\n\nvar snapshotToData = function (snapshot, snapshotOptions, idField, refField, transform) {\r\n    if (!snapshot.exists()) {\r\n        return undefined;\r\n    }\r\n    var data = snapshot.data(snapshotOptions);\r\n    if (transform) {\r\n        data = transform(data);\r\n    }\r\n    if (idField) {\r\n        data[idField] = snapshot.id;\r\n    }\r\n    if (refField) {\r\n        data[refField] = snapshot.ref;\r\n    }\r\n    return data;\r\n};\r\nvar isRefEqual = function (v1, v2) {\r\n    var bothNull = !v1 && !v2;\r\n    var equal = !!v1 && !!v2 && refEqual(v1, v2);\r\n    return bothNull || equal;\r\n};\r\nvar useIsFirestoreRefEqual = function (value, onChange) {\r\n    return useComparatorRef(value, isRefEqual, onChange);\r\n};\r\nvar isQueryEqual = function (v1, v2) {\r\n    var bothNull = !v1 && !v2;\r\n    var equal = !!v1 && !!v2 && queryEqual(v1, v2);\r\n    return bothNull || equal;\r\n};\r\nvar useIsFirestoreQueryEqual = function (value, onChange) {\r\n    return useComparatorRef(value, isQueryEqual, onChange);\r\n};\n\nvar useCollection = function (query, options) {\r\n    return useCollectionInternal(true, query, options);\r\n};\r\nvar useCollectionOnce = function (query, options) {\r\n    return useCollectionInternal(false, query, options);\r\n};\r\nvar useCollectionData = function (query, options) {\r\n    return useCollectionDataInternal(true, query, options);\r\n};\r\nvar useCollectionDataOnce = function (query, options) {\r\n    return useCollectionDataInternal(false, query, options);\r\n};\r\nvar useCollectionInternal = function (listen, query, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsFirestoreQueryEqual(query, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        if (listen) {\r\n            var unsubscribe_1 = options && options.snapshotListenOptions\r\n                ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError)\r\n                : onSnapshot(ref.current, setValue, setError);\r\n            return function () {\r\n                unsubscribe_1();\r\n            };\r\n        }\r\n        else {\r\n            var effectActive_1 = true;\r\n            var get = getDocsFnFromGetOptions(options ? options.getOptions : undefined);\r\n            get(ref.current)\r\n                .then(function (result) {\r\n                if (effectActive_1) {\r\n                    setValue(result);\r\n                }\r\n            })\r\n                .catch(function (error) {\r\n                if (effectActive_1) {\r\n                    setError(error);\r\n                }\r\n            });\r\n            return function () {\r\n                effectActive_1 = false;\r\n            };\r\n        }\r\n    }, [ref.current]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nvar useCollectionDataInternal = function (listen, query, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var refField = options ? options.refField : undefined;\r\n    var snapshotOptions = options ? options.snapshotOptions : undefined;\r\n    var transform = options ? options.transform : undefined;\r\n    var _a = useCollectionInternal(listen, query, options), snapshots = _a[0], loading = _a[1], error = _a[2];\r\n    var values = useMemo(function () {\r\n        return (snapshots\r\n            ? snapshots.docs.map(function (doc) {\r\n                return snapshotToData(doc, snapshotOptions, idField, refField, transform);\r\n            })\r\n            : undefined);\r\n    }, [snapshots, snapshotOptions, idField, refField, transform]);\r\n    var resArray = [\r\n        values,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nfunction getDocsFnFromGetOptions(_a) {\r\n    var source = (_a === void 0 ? { source: 'default' } : _a).source;\r\n    switch (source) {\r\n        default:\r\n        case 'default':\r\n            return getDocs;\r\n        case 'cache':\r\n            return getDocsFromCache;\r\n        case 'server':\r\n            return getDocsFromServer;\r\n    }\r\n}\n\nvar useDocument = function (docRef, options) {\r\n    return useDocumentInternal(true, docRef, options);\r\n};\r\nvar useDocumentOnce = function (docRef, options) {\r\n    return useDocumentInternal(false, docRef, options);\r\n};\r\nvar useDocumentData = function (docRef, options) {\r\n    return useDocumentDataInternal(true, docRef, options);\r\n};\r\nvar useDocumentDataOnce = function (docRef, options) {\r\n    return useDocumentDataInternal(false, docRef, options);\r\n};\r\nvar useDocumentInternal = function (listen, docRef, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsFirestoreRefEqual(docRef, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        if (listen) {\r\n            var unsubscribe_1 = options && options.snapshotListenOptions\r\n                ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError)\r\n                : onSnapshot(ref.current, setValue, setError);\r\n            return function () {\r\n                unsubscribe_1();\r\n            };\r\n        }\r\n        else {\r\n            var effectActive_1 = true;\r\n            var get = getDocFnFromGetOptions(options ? options.getOptions : undefined);\r\n            get(ref.current)\r\n                .then(function (doc) {\r\n                if (effectActive_1) {\r\n                    setValue(doc);\r\n                }\r\n            })\r\n                .catch(function (error) {\r\n                if (effectActive_1) {\r\n                    setError(error);\r\n                }\r\n            });\r\n            return function () {\r\n                effectActive_1 = false;\r\n            };\r\n        }\r\n    }, [ref.current]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nvar useDocumentDataInternal = function (listen, docRef, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var refField = options ? options.refField : undefined;\r\n    var snapshotOptions = options ? options.snapshotOptions : undefined;\r\n    var transform = options ? options.transform : undefined;\r\n    var _a = useDocumentInternal(listen, docRef, options), snapshot = _a[0], loading = _a[1], error = _a[2];\r\n    var value = useMemo(function () {\r\n        return (snapshot\r\n            ? snapshotToData(snapshot, snapshotOptions, idField, refField, transform)\r\n            : undefined);\r\n    }, [snapshot, snapshotOptions, idField, refField, transform]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nfunction getDocFnFromGetOptions(_a) {\r\n    var source = (_a === void 0 ? { source: 'default' } : _a).source;\r\n    switch (source) {\r\n        default:\r\n        case 'default':\r\n            return getDoc;\r\n        case 'cache':\r\n            return getDocFromCache;\r\n        case 'server':\r\n            return getDocFromServer;\r\n    }\r\n}\n\nexport { useCollection, useCollectionOnce, useCollectionData, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };\n"]},"metadata":{},"sourceType":"module"}