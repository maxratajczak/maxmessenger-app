{"ast":null,"code":"import _asyncToGenerator from\"/Users/maximilian/GitHub/maxmessenger-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maximilian/GitHub/maxmessenger-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/maximilian/GitHub/maxmessenger-app/node_modules/@babel/runtime/regenerator/index.js\";import{useCollectionData}from'react-firebase-hooks/firestore';import{useRef,useState}from'react';import ChatMessage from'./ChatMessage';import'../css/ChatRoom.css';import chatIcon from'../g-icon.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatRoom=function ChatRoom(_ref){var firebase=_ref.firebase,auth=_ref.auth,firestore=_ref.firestore,user=_ref.user,name=_ref.name;var messagesRef=firestore.collection('messages');var query=messagesRef.orderBy('createdAt');var _useCollectionData=useCollectionData(query,{idField:'id'}),_useCollectionData2=_slicedToArray(_useCollectionData,1),messages=_useCollectionData2[0];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),formValue=_useState2[0],setFormValue=_useState2[1];var dummyDiv=useRef();var sendMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _auth$currentUser,uid,photoURL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(formValue!==\"\")){_context.next=7;break;}_auth$currentUser=auth.currentUser,uid=_auth$currentUser.uid,photoURL=_auth$currentUser.photoURL;_context.next=5;return messagesRef.add({text:formValue,createdAt:firebase.firestore.FieldValue.serverTimestamp(),uid:uid,photoURL:photoURL,sentBy:user.displayName});case 5:setFormValue(\"\");dummyDiv.current.scrollIntoView({behavior:\"smooth\"});case 7:case\"end\":return _context.stop();}}},_callee);}));return function sendMessage(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"ChatRoom\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"topBar\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"chatIcon\",src:chatIcon,alt:\"\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"chatRoomName\",children:name})]}),/*#__PURE__*/_jsx(\"div\",{children:messages&&messages.map(function(msg){return/*#__PURE__*/_jsx(ChatMessage,{auth:auth,user:user,message:msg},msg.id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"dummyDiv\",ref:dummyDiv}),user?/*#__PURE__*/_jsx(\"div\",{className:\"sendMessageForm\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendMessage,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Type a message...\",type:\"text\",value:formValue,onChange:function onChange(e){return setFormValue(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"sendButton\",type:\"submit\",children:\"Send\"})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"sendMessageForm\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:sendMessage,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Log in to send a message\",disabled:true,type:\"text\",value:formValue,onChange:function onChange(e){return setFormValue(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"sendButton disabled\",disabled:true,type:\"submit\",children:\"Send\"})]})})]})});};export default ChatRoom;","map":{"version":3,"sources":["/Users/maximilian/GitHub/maxmessenger-app/src/components/ChatRoom.js"],"names":["useCollectionData","useRef","useState","ChatMessage","chatIcon","ChatRoom","firebase","auth","firestore","user","name","messagesRef","collection","query","orderBy","idField","messages","formValue","setFormValue","dummyDiv","sendMessage","e","preventDefault","currentUser","uid","photoURL","add","text","createdAt","FieldValue","serverTimestamp","sentBy","displayName","current","scrollIntoView","behavior","map","msg","id","target","value"],"mappings":"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","sourcesContent":["import { useCollectionData } from 'react-firebase-hooks/firestore'\nimport { useRef, useState } from 'react';\nimport ChatMessage from './ChatMessage';\nimport '../css/ChatRoom.css'\nimport chatIcon from '../g-icon.png'\n\nconst ChatRoom = ({firebase, auth, firestore, user, name}) => {\n    const messagesRef = firestore.collection('messages');\n    const query = messagesRef.orderBy('createdAt');\n\n    const [messages] = useCollectionData(query, {idField: 'id'});\n    const [formValue, setFormValue] = useState(\"\");\n    const dummyDiv = useRef();\n    \n    const sendMessage = async(e) => {\n        e.preventDefault();\n        if(formValue !== \"\") {\n            const { uid, photoURL } = auth.currentUser;\n\n            await messagesRef.add({\n                text: formValue,\n                createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n                uid,\n                photoURL,\n                sentBy: user.displayName\n            });\n            setFormValue(\"\")\n\n            dummyDiv.current.scrollIntoView({ behavior: \"smooth\" });\n        }\n        \n    }\n    \n    return (\n    <div className='ChatRoom'>\n        \n        <div className='chat'>\n            <div className='topBar'>\n                <img className='chatIcon' src={chatIcon} alt=\"\" />\n                <h4 className='chatRoomName'>{name}</h4>\n            </div>\n            <div>\n                {messages && messages.map(msg => <ChatMessage auth={auth} user={user} key={msg.id} message={msg}/>)}\n            </div>\n            <div className='dummyDiv' ref={dummyDiv}></div>\n            {user ? \n            <div className='sendMessageForm'>\n                <form onSubmit={sendMessage}>\n                    <input placeholder='Type a message...' type=\"text\" value={formValue} onChange={(e) => setFormValue(e.target.value)} />\n                    <button className='sendButton' type='submit'>Send</button>\n                </form>\n            </div>\n            :\n            <div className='sendMessageForm'>\n                <form onSubmit={sendMessage}>\n                    <input placeholder='Log in to send a message' disabled type=\"text\" value={formValue} onChange={(e) => setFormValue(e.target.value)} />\n                    <button className='sendButton disabled' disabled type='submit'>Send</button>\n                </form>\n            </div>\n            }\n        </div>\n    </div>\n    )\n}\n \nexport default ChatRoom;"]},"metadata":{},"sourceType":"module"}